@use 'sass:color';
@use '../../../styles/variables' as *;
@use '../../../styles/mixins' as *;

// ==========================================================================
// Hero Background â€” Ambient scene + Lottie illustration
// ==========================================================================

// --------------------------------------------------------------------------
// Keyframes
// --------------------------------------------------------------------------

@keyframes gradient-flow {
  0%   { background-position: 0% 50%; }
  50%  { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}

@keyframes rise {
  0% {
    transform: translateY(0) translateX(0);
    opacity: 0;
  }
  10% { opacity: var(--p-opacity, 0.3); }
  90% { opacity: var(--p-opacity, 0.3); }
  100% {
    transform: translateY(-100vh) translateX(var(--p-drift, 10px));
    opacity: 0;
  }
}

@keyframes breathe-ring {
  0%, 100% {
    transform: translate(-50%, -50%) scale(var(--ring-min, 0.85));
    opacity: var(--ring-opacity, 0.08);
  }
  50% {
    transform: translate(-50%, -50%) scale(var(--ring-max, 1));
    opacity: calc(var(--ring-opacity, 0.08) * 1.5);
  }
}

@keyframes glow-pulse {
  0%, 100% { box-shadow: 0 0 4px 1px currentColor; }
  50%      { box-shadow: 0 0 8px 3px currentColor; }
}

@keyframes fade-in {
  0%   { opacity: 0; }
  100% { opacity: 1; }
}

@keyframes lottie-enter {
  0%   { opacity: 0; transform: translateX(-50%) scale(0.95); }
  100% { opacity: 1; transform: translateX(-50%) scale(1); }
}

@keyframes leaf-float {
  0%, 100% {
    transform: translateY(0) translateX(0) rotate(var(--leaf-rot, 0deg));
    opacity: var(--leaf-opacity, 0.15);
  }
  25% {
    transform: translateY(var(--leaf-y, -12px)) translateX(var(--leaf-x, 6px)) rotate(calc(var(--leaf-rot, 0deg) + 5deg));
  }
  50% {
    transform: translateY(calc(var(--leaf-y, -12px) * 0.5)) translateX(calc(var(--leaf-x, 6px) * -1)) rotate(calc(var(--leaf-rot, 0deg) - 3deg));
    opacity: calc(var(--leaf-opacity, 0.15) * 1.3);
  }
  75% {
    transform: translateY(calc(var(--leaf-y, -12px) * 0.3)) translateX(calc(var(--leaf-x, 6px) * 0.5)) rotate(calc(var(--leaf-rot, 0deg) + 2deg));
  }
}

// --------------------------------------------------------------------------
// Scene container
// --------------------------------------------------------------------------
.scene {
  position: absolute;
  inset: 0;
  overflow: hidden;
  pointer-events: none;
  z-index: 0;
  animation: fade-in 2s ease-out both;
}

// --------------------------------------------------------------------------
// Flowing gradient
// --------------------------------------------------------------------------
.gradient {
  position: absolute;
  inset: -20%;
  background: linear-gradient(
    135deg,
    color.adjust($color-secondary, $lightness: 10%) 0%,
    $color-bg 20%,
    color.adjust($color-neutral, $lightness: 6%) 40%,
    $color-bg 60%,
    color.adjust($color-secondary, $lightness: 8%) 80%,
    $color-bg 100%
  );
  background-size: 300% 300%;
  animation: gradient-flow 25s ease-in-out infinite;
  opacity: 0.6;
}

// --------------------------------------------------------------------------
// Breathing rings
// --------------------------------------------------------------------------
.rings {
  position: absolute;
  top: 50%;
  left: 50%;
  width: 100%;
  height: 100%;
  transform: translate(-50%, -50%);
}

.ring {
  position: absolute;
  top: 50%;
  left: 50%;
  border-radius: 50%;
  border: 1px solid $color-primary;
  will-change: transform, opacity;
  animation: breathe-ring 8s ease-in-out infinite;
}

.ring1 {
  --ring-min: 0.9;
  --ring-max: 1;
  --ring-opacity: 0.07;
  width: clamp(280px, 45vw, 520px);
  height: clamp(280px, 45vw, 520px);
  animation-duration: 8s;
}

.ring2 {
  --ring-min: 0.88;
  --ring-max: 1;
  --ring-opacity: 0.05;
  width: clamp(380px, 60vw, 700px);
  height: clamp(380px, 60vw, 700px);
  animation-duration: 10s;
  animation-delay: -2s;
}

.ring3 {
  --ring-min: 0.86;
  --ring-max: 1;
  --ring-opacity: 0.03;
  width: clamp(480px, 75vw, 900px);
  height: clamp(480px, 75vw, 900px);
  animation-duration: 12s;
  animation-delay: -4s;
}

// --------------------------------------------------------------------------
// Lottie illustration wrapper
// --------------------------------------------------------------------------
.lottieWrap {
  position: absolute;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  width: clamp(260px, 40vw, 480px);
  max-height: 65%;
  opacity: 0;
  animation: lottie-enter 1.5s ease-out 0.5s forwards;

  @include respond-to('md') {
    width: clamp(300px, 35vw, 500px);
  }

  @include respond-to('lg') {
    width: clamp(340px, 30vw, 520px);
  }
}

.lottie {
  width: 100%;
  height: 100%;
  opacity: 0.35;
  filter: saturate(0.6) brightness(1.1);

  @include respond-to('md') {
    opacity: 0.4;
  }
}

// --------------------------------------------------------------------------
// Floating leaves
// --------------------------------------------------------------------------
.leaf {
  position: absolute;
  color: $color-primary;
  will-change: transform;
  animation: leaf-float ease-in-out infinite;
}

.leafA {
  --leaf-rot: -20deg;
  --leaf-y: -16px;
  --leaf-x: 8px;
  --leaf-opacity: 0.12;
  width: 28px;
  top: 14%;
  left: 8%;
  animation-duration: 18s;

  @include respond-to('lg') { width: 36px; }
}

.leafB {
  --leaf-rot: 25deg;
  --leaf-y: -12px;
  --leaf-x: -6px;
  --leaf-opacity: 0.1;
  width: 22px;
  top: 20%;
  right: 10%;
  animation-duration: 22s;
  animation-delay: -5s;

  @include respond-to('lg') { width: 30px; }
}

.leafC {
  --leaf-rot: -35deg;
  --leaf-y: -20px;
  --leaf-x: 10px;
  --leaf-opacity: 0.08;
  width: 18px;
  bottom: 28%;
  left: 12%;
  animation-duration: 20s;
  animation-delay: -8s;

  @include respond-to('lg') { width: 24px; }
}

.leafD {
  --leaf-rot: 15deg;
  --leaf-y: -14px;
  --leaf-x: -8px;
  --leaf-opacity: 0.1;
  width: 24px;
  bottom: 18%;
  right: 14%;
  animation-duration: 24s;
  animation-delay: -3s;

  @include respond-to('lg') { width: 32px; }
}

.leafE {
  --leaf-rot: 40deg;
  --leaf-y: -10px;
  --leaf-x: 4px;
  --leaf-opacity: 0.07;
  width: 20px;
  top: 50%;
  right: 25%;
  animation-duration: 26s;
  animation-delay: -12s;

  @include respond-to('lg') { width: 26px; }
}

// --------------------------------------------------------------------------
// Light particles
// --------------------------------------------------------------------------
.particles {
  position: absolute;
  inset: 0;
}

.particle {
  position: absolute;
  bottom: -5%;
  left: var(--p-left, 50%);
  width: var(--p-size, 3px);
  height: var(--p-size, 3px);
  border-radius: 50%;
  background-color: $color-primary;
  color: color.adjust($color-primary, $lightness: 10%);
  opacity: 0;
  will-change: transform, opacity;
  animation:
    rise var(--p-duration, 18s) ease-in-out var(--p-delay, 0s) infinite,
    glow-pulse 3s ease-in-out var(--p-delay, 0s) infinite;
}

// --------------------------------------------------------------------------
// Reduced motion
// --------------------------------------------------------------------------
@media (prefers-reduced-motion: reduce) {
  .scene {
    animation: none;
    opacity: 1;
  }

  .gradient {
    animation: none;
    opacity: 0.4;
  }

  .ring {
    animation: none;
    transform: translate(-50%, -50%) scale(1);
  }

  .particle {
    animation: none;
    opacity: 0;
  }

  .lottieWrap {
    animation: none;
    opacity: 1;
    transform: translateX(-50%);
  }

  .leaf {
    animation: none;
  }
}
